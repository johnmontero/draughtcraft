<%
  def printable_type(type):
    return ({
      'MASH'          : 'All-Grain',
      'MINIMASH'      : 'Extract w/ Mini-Mash',
      'EXTRACTSTEEP'  : 'Extract w/ Steeped Grains',
      'EXTRACT'       : 'Extract'
    })[type] 
%>

<%inherit file="../../layout.html" />

<%def name="style()">
    <link rel="stylesheet/less" type="text/css" media="screen" href="/css/recipes/browse.less" />
</%def>

<%def name="javascript()">
    <script type="text/javascript" src="/javascript/recipes/browse.js"></script>
</%def>

<br />

<div id="searchbar">
  <form method="POST">
    <ul class="primary clearfix">
      <li class="first">
        <span class="placeholder">
          <a href="#">Any Style</a>
        </span>
        <span class="down"></span>
        <ul class="secondary">
          <li>
            <a rel="">Any Style</a>
          </li>
          % for style in styles:
          <li>
            <a rel="${style.id}">${style.name}</a>
          </li>
          % endfor
        </ul>
        <input type="hidden" name="style" />
      </li>
      <li class="btn enabled">
        <a href="#">All Grain</a>
        <input type="hidden" name="mash" />
      </li>
      <li class="btn enabled">
        <a href="#">Mini-Mash</a>
        <input type="hidden" name="minimash" />
      </li>
      <li class="btn enabled">
        <a href="#">Extract</a>
        <input type="hidden" name="extract" />
      </li>
      <li class="srm">
        <span class="placeholder">
          <span class="srm">
            <a rel="">
              <img src="/images/glass-search.png" height="40" class="glass" title="Any Color" />
            </a>
          </span>
        </span>
        <span class="down"></span>
        <ul class="secondary srm">
          <li>
            <span class="srm">
              <a rel="">
                <img src="/images/glass-search.png" height="40" class="glass" title="Any Color" />
              </a>
            </span>
          </li>
          <li>
            <span class="srm srm-7">
              <a rel="light">
                <img src="/images/glass-search.png" height="40" class="glass" title="Light" />
              </a>
            </span>
          </li>
          <li>
            <span class="srm srm-10">
              <a rel="amber">
                <img src="/images/glass-search.png" height="40" class="glass" title="Amber" />
              </a>
            </span>
          </li>
          <li>
            <span class="srm srm-18">
              <a rel="brown">
                <img src="/images/glass-search.png" height="40" class="glass" title="Brown" />
              </a>
            </span>
          </li>
          <li>
            <span class="srm srm-25">
              <a rel="dark">
                <img src="/images/glass-search.png" height="40" class="glass" title="Dark" />
              </a>
            </span>
          </li>
        </ul>
        <input type="hidden" name="color" />
      </li>
      <li class="search">
        <input
          name="search"
          type="search"
          placeholder="Search Recipes..."
          value="${static('search', '')}"
          autosave="com.draughtcraft.search"
          incremental="true" 
          results="5"
        />
      </li>
    </ul>
  </form>
</div>

<div>
  <table class="results">
    <tr>
      <th>Type</th>
      <th>Name</th>
      <th>Author</th>
      <th>Style</th>
      <th class="lastchanged">Last Changed</th>
      <th class="views"># Views</th>
    </tr>
    % for r in recipes:
      <tr>
        <td>${printable_type(r.type)}</td>
        <td>
          <a href="${r.url()}">
            ${r.name}
          </a>
        </td>
        <td>
          <a href="/profile/${r.author.username}">
            ${r.author.full_name.strip() or r.author.username}
          </a>
        </td>
        <td>${r.style.name}</td>
        <td class="lastchanged">${h.format_age(r.last_updated)}</td>
        <td class="views">${len(r.views)}</td>
      </tr>
    % endfor
  </table>
</div>
