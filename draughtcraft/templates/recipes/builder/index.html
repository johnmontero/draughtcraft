<%inherit file="../../layout.html" />

<%def name="style()">
    <link rel="stylesheet/less" type="text/css" media="screen" href="/css/recipes/builder.less" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.selectbox.css" />
</%def>

<%def name="javascript()">
    <script type="text/javascript" src="/javascript/jquery.form.min.js"></script>
    <script type="text/javascript" src="/javascript/recipes/builder.js"></script>
    <script type="text/javascript" src="/javascript/jquery.selectbox.min.js"></script>
</%def>

<div id="builder">

  <h1>${recipe.name}</h1> 
  <fieldset>
    ${h.form('async/settings/style')}
      ${h.select(
        'target', 
        recipe.style.id if recipe.style else None, 
        [('', 'No Target Style Chosen')] + [(s.id, s.name) for s in h.model.Style.query.order_by(h.model.Style.name).all()],
      )}
    ${h.end_form()}
  </fieldset>
  <fieldset>
    ${h.form('async/settings/volume')}
      ${h.select(
        'volume', 
        [recipe.gallons],
        [(float(v), '%s Gallon(s)' % v) for v in [1, 2, 2.5, 3, 4, 5, 8, 10, 15, 20, 25]],
        class_ = 'gallons'
      )}
      ${h.hidden(
        'unit',
        'GALLON'
      )}
    ${h.end_form()}
  </fieldset>

  % if recipe.author:
    <a href="/profile/${recipe.author.username}">
      <img 
        src="${recipe.author.gravatar}&s=45" 
        class="gravatar"
        title="${recipe.author.username}"
      />
    </a>
  % endif

  <div id="builder-ajax">
    <div class="builder-loading">
      <img src="/images/loading.gif" /> 
    </div>
  </div>

</div>
